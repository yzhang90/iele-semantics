; ERC20-EVM Specification Template Parameters
; For more details, refer to README.md.

[totalSupply]
k: (#execute => #end) ~> _
output: _ => (TOTAL_SUPPLY, .Ints)
callStack: _
callDepth: _
localCalls: .List
callData: .Ints
callValue: _
regs: .Map => _
localMem: .Map => _
peakMem: _ => _
currentMem: _ => _
fid: totalSupply
gas: #infinity
log: _
refund: _
activeAccounts: _
storage:
    0 |-> TOTAL_SUPPLY
    _:Map
requires:

[balanceOf]
k: (#execute => #end) ~> _
output: _ => (BAL, .Ints)
callStack: _
callDepth: _
localCalls: .List
callData: OWNER_ID, .Ints
callValue: _
regs: (0 |-> OWNER .Map) => _
localMem: .Map => _
peakMem: _ => _
currentMem: _ => _
fid: balanceOf
gas: #infinity
log: _
refund: _
activeAccounts: _
storage:
    #mapKey(1, OWNER) |-> BAL
    _:Map
requires:

[allowance]
k: (#execute => #end) ~> _
output: _ => (ALLOWANCE, .Ints)
callStack: _
callDepth: _
localCalls: .List
callData: OWNER, SPENDER, .Ints
callValue: _
regs:
    (0 |-> OWNER
     1 |-> SPENDER
     .Map) => _
localMem: .Map => _
peakMem: _ => _
currentMem: _ => _
fid: allowance
gas: #infinity
log: _
refund: _
activeAccounts: _
storage:
    #mapKey(#mapKey(2, OWNER), SPENDER) |-> ALLOWANCE
    _:Map
requires:

[approve]
callStack: _
callDepth: _
localCalls: .List
callData: SPENDER, VALUE, .Ints
callValue: _
regs:
    (0 |-> SPENDER
     1 |-> VALUE
     .Map) => _
localMem: .Map => _
peakMem: _ => _
currentMem: _ => _
fid: approve
gas: #infinity
refund: _ => _
activeAccounts: _
requires:
    andBool 0 <=Int SPENDER
    andBool SPENDER <Int pow160

[approve-success]
k: (#execute => #end) ~> _
output: _ => (1, .Ints)
log: _:List ( .List => ListItem(#eventLog(ACCT_ID, #topics(#approvalEvent, CALLER_ID, SPENDER), Int2Bytes(VALUE, LE, Signed))) )
storage:
    #mapKey(#mapKey(2, CALLER_ID), SPENDER) |-> (_ => VALUE)
    _:Map
+requires:
    andBool VALUE >=Int 0

[approve-fail]
k: (#execute => #exception(4)) ~> _
output: _ => _
log: _
storage:
    _:Map
+requires:
    andBool VALUE <Int 0

[transfer]
callStack: _
callDepth: _
localCalls: .List
callData: TO_ID, VALUE, .Ints
callValue: _
regs:
    (0 |-> TO_ID
     1 |-> VALUE
     .Map) => _
localMem: .Map => _
peakMem: _ => _
currentMem: _ => _
fid: transfer
gas: #infinity
refund: _ => _
activeAccounts: _
requires:
    andBool 0 <=Int TO_ID
    andBool TO_ID <Int pow160

[transfer-success]
k: (#execute => #end) ~> _
output: _ => (1, .Ints)
log: _:List ( .List => ListItem(#eventLog(ACCT_ID, #topics(#transferEvent, CALLER_ID, TO_ID), Int2Bytes(VALUE, LE, Signed))) )
+requires:
    andBool 0 <=Int VALUE

[transfer-success-1]
storage:
    #mapKey(1, CALLER_ID) |-> (BAL_FROM => BAL_FROM -Int VALUE)
    #mapKey(1, TO_ID)     |-> (BAL_TO   => BAL_TO   +Int VALUE)
    _:Map
+requires:
    andBool CALLER_ID =/=Int TO_ID
    andBool VALUE <=Int BAL_FROM

[transfer-success-2]
storage:
    #mapKey(1, CALLER_ID) |-> BAL_FROM
    _:Map
+requires:
    andBool CALLER_ID ==Int TO_ID
    andBool VALUE <=Int BAL_FROM

[transfer-failure]
k: (#execute => #exception(4)) ~> _
output: _ => _
log: _

[transfer-failure-1]
storage:
    _:Map
+requires:
    andBool VALUE <Int 0

[transfer-failure-2]
storage:
    #mapKey(1, CALLER_ID) |-> (BAL_FROM => _)
    #mapKey(1, TO_ID)     |-> BAL_TO
    _:Map
+requires:
    andBool 0 <=Int VALUE
    andBool CALLER_ID =/=Int TO_ID
    andBool VALUE >Int BAL_FROM

[transfer-failure-3]
storage:
    #mapKey(1, CALLER_ID) |-> BAL_FROM
    _:Map
+requires:
    andBool 0 <=Int VALUE
    andBool CALLER_ID ==Int TO_ID
    andBool VALUE >Int BAL_FROM


[pgm]
code: "0000028D63046900066D61704B657969000A73657442616C616E636569000C736574416C6C6F77616E636569000C6C6F672E417070726F76616C69000C6C6F672E5472616E7366657269000B746F74616C537570706C7969000962616C616E63654F66690009616C6C6F77616E6365690007617070726F76656900087472616E7366657269000C7472616E7366657246726F6D67000100026114020C01236181A0041B0405170356F60001066700020002610102F800010002000100235531F600006700030003610203F80001000200010034F800010002000101455552F600006700040003618003533261A07134692B230B9E1FFA39098904722134159652B09C5BC41D88D6698779D228FF04A31043F600006700050003618003533261A0F099CD8BDE557814842A3121E8DDFD433A539B8C9F14BF31EBF108D12E6196E904A31043F6000068000600006180005401F6000101670000000161800155103302F800020002000002F600006800070001610101F800010002000100125423F60001036800080002610202F80001000200010023F800010002000101345445F60001056800090002618002100213650000033304F80003000300000104F80004000300000104610102F6000102660000FE68000A0002618002100213650000033304F80007000100014510015365000003030155F800020002000054F800070001000106010166F800020002000060F80005000300000104610102F6000102660000FE68000B0003618003100324650000043305F80007000100010610026465000004F8000800020001050710027465000004030266F800020002000060030277F80003000300000750F800070001000118010288F800020002000081F80005000300000210610103F6000103660000FE"
